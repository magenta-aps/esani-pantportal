{# SPDX-FileCopyrightText: 2023 Magenta ApS <info@magenta.dk> #}
{# SPDX-License-Identifier: MPL-2.0 #}
{# This file was originally from the Django Ninja source code. Available under an MIT license, Copyright (c) 2025 Vitaliy Kucheryaviy. #}
{# Github repo: https://github.com/vitalik/django-ninja #}
{# Modified to add nonce attributes to <script> and <link> tags #}

<!DOCTYPE html>
<html>
<head>
    <link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swagger-ui-dist@4.15.5/swagger-ui.css" nonce="{{request.csp_nonce}}">
    <link rel="shortcut icon" href="https://django-ninja.rest-framework.com/img/favicon.png" nonce="{{request.csp_nonce}}">
    <title>{{ api.title }}</title>
</head>
<body>
<div id="swagger-ui">
</div>
{# Copy of ninja/templates/swagger_cdn.html, with CSP attributes inserted #}
<script src="https://cdn.jsdelivr.net/npm/swagger-ui-dist@4.15.5/swagger-ui-bundle.js" nonce="{{request.csp_nonce}}"></script>
<script nonce="{{request.csp_nonce}}">
    const ui = SwaggerUIBundle({
        url: '{{ openapi_json_url }}',
        dom_id: '#swagger-ui',
        presets: [
            SwaggerUIBundle.presets.apis,
            SwaggerUIBundle.SwaggerUIStandalonePreset
        ],
        layout: "BaseLayout",
    {% if api.csrf and csrf_token %}
    requestInterceptor: (req) => {
        req.headers['X-CSRFToken'] = "{{csrf_token}}"
        return req;
    },
    {% endif %}
    deepLinking: true
    })
</script>
</body>
</html>
